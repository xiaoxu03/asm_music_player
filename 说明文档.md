# 汇编与编原第一次小组作业-音乐播放器说明文档
## 开发环境
* 开发使用的操作系统为Windows 11，编辑器为RadASM 2.2.4，win32运行库为Masm。
* 支持使用Visual Studio打开，将asm文件复制进配置好的win32汇编项目即可。
## 实现原理
* 搭建界面使用createwindowex函数，创建各个控件，并通过MoveWindow函数调整控件的位置。
* 通过SHBrowseForFolder浏览并选择根目录。
* 通过ListBox对音乐文件进行浏览。
* 通过MCI实现对于音乐播放的控制和对音乐播放状态的监控。
* 使用TrackerBar和静态文本显示和控制音乐播放进度。
* 通过对状态机的更新和对MCI设备的控制实现了暂停、停止、单曲循环等等功能。
## 难点和创新点
### 难点
#### 1.通过汇编语言对字符串进行拼接与修改
在实现软件的过程中，需要通过字符串操作来得到文件的真正目录，并拼接出播放指令。然而，并没有类似strcat这样的函数，因此就只能操纵寄存器和栈来实现这些功能了，十分繁琐和复杂。
#### 2.实现单曲循环
单曲循环涉及到一个状态检测的过程，但是并没有类似于qt的信号和槽的监听机制，所以选择使用Timer进行轮询来实现。当单曲循环的复选框被选中且播放完成（当前毫秒位置和总长度相等）时，就跳转进度并再次播放。

### 创新点
#### 1.使用状态机对音乐播放进行处理，确保了运行的稳定性
通过两个状态机（文件夹状态机和播放状态机）来维护播放器状态，确保了播放逻辑的正常进行，尽最大可能杜绝错误的发生。
#### 2.使用Timer对音乐播放状态进行实时监测和更新
通过计时器定时触发，使用轮询的方式，完成了对进度的检测和对特殊播放模式的实现。

### 附加功能（与中期相比的进度）
#### 1.通过ProgressBar对音乐播放进度进行控制
现在我们可以通过对进度条的拖拽实现对播放进度的控制了。
#### 2.实现列表循环
现在通过列表循环单选框，可以选择播放完一首歌之后按照播放列表上的顺序播放下一首歌了。
#### 3.实现随机循环
现在通过随机循环单选框，可以选择播放完一首歌之后随机播放列表上的另一首歌了。

#### 5.优化用户界面
## 小组分工：
* 罗一鹤：界面、框架搭建，创建控件，增加拓展功能。
* 徐超：实现基础功能，撰写说明文档，录制演示视频。
* 林智鑫：撰写文档，修复bug。